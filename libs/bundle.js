!function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";i(1),i(2),i(3),i(4),i(5),i(6)},function(t,e){"use strict";e.app=angular.module("app",["ngMaterial","ui.router","ngMessages","ngStorage"])},function(t,e,i){"use strict";var n=i(1).app;n.config(["$urlRouterProvider","$locationProvider",function(t,e){e.html5Mode(!0),t.when("","/").otherwise("/")}]),n.config(["$stateProvider",function(t){t.state("index",{url:"/",controller:"IndexController",templateUrl:"/public/views/index.html"}).state("index.image",{url:"{id:int}",controller:"ImageController",templateUrl:"/public/views/image.html"}).state("history",{url:"/history",controller:"HistoryController",templateUrl:"/public/views/history.html"})}])},function(t,e,i){"use strict";var n=i(1).app;n.controller("MainController",["$scope","$mdSidenav","$state","$mdDialog","$localStorage","$interval","$location","$http",function(t,e,i,n,o,a,r,l){o.$default({autoChange:!1,autoShowHelpInfo:!0,imagesHistory:[]}),t.autoChange={status:o.autoChange,interval:null},t.setAutoChange=function(){o.autoChange=t.autoChange.status},t.historyIndex=!1,t.setHistoryIndex=function(e){t.historyIndex=e},t.index=0,t.setIndex=function(e){t.index=e},t.images=[],t.openMenu=function(){e("left").toggle()},t.helpDialog={autoShow:o.autoShowHelpInfo},t.setHelpInfo=function(){o.autoShowHelpInfo=t.helpDialog.autoShow},t.showHelpDialog=function(){t.dialog=n.show({preserveScope:!0,scope:t,templateUrl:"/public/views/help.html",parent:angular.element(document.body),clickOutsideToClose:!0})},t.closeDialog=function(){n.hide(t.dialog)},t.menus=[{name:"首页",icon:"home",click:function(){r.path().match(/^\/\d{1,}$/)||i.go("index")}},{name:"浏览记录",icon:"history",click:function(){return i.go("history")}},{name:"帮助",icon:"help_outline",click:function(){return t.showHelpDialog()}},{name:"关于本项目",icon:"code",click:function(){window.location="https://github.com/gyteng/jandan-ooxx"}}],t.menuClick=function(i){t.menus[i].click(),e("left").close()},t.$on("$stateChangeStart",function(e,i,n,o,r,l){"index.image"===o.name&&"index.image"!==i.name&&t.autoChange.interval&&a.cancel(t.autoChange.interval)}),t.public={currentImage:{},images:[],history:o.imagesHistory},t.getImage=function(){return l.get("/api/image",{params:{number:15}}).then(function(e){return e.data.forEach(function(e){t.public.images.push(e)}),e})},t.getImageById=function(e){return l.get("/api/image/"+e).then(function(e){return t.public.images.push(e.data),e})},t.$watch("public.images",function(){t.public.images.length<15&&t.getImage()}),t.addHistory=function(e){t.public.history.push(e)},t.setCurrentImage=function(e){if(e){var i=t.public.images.filter(function(t){return t.id===e})[0];i?t.public.currentImage=i:t.getImageById(e).then(function(){t.setCurrentImage(e)})}else t.public.images.length?t.public.currentImage=t.public.images[0]:t.getImage.then(function(){t.setCurrentImage()})},t.randomImage=function(){t.public.images.length>1?(t.public.images.splice(0,1),t.public.currentImage=t.public.images[0],t.addHistory(t.public.images[0]),i.go("index.image",{id:t.public.currentImage.id})):t.getImage().then(function(){t.randomImage()})}}])},function(t,e,i){"use strict";var n=i(1).app;n.controller("IndexController",["$scope","$http","$state","$stateParams","$timeout","$interval","$localStorage","$location",function(t,e,i,n,o,a,r,l){console.log("GG")}])},function(t,e,i){"use strict";var n=i(1).app;n.controller("ImageController",["$scope","$http","$state","$stateParams","$timeout","$interval","$localStorage",function(t,e,i,n,o,a,r){var l=n.id;t.setCurrentImage(l)}])},function(t,e,i){"use strict";var n=i(1).app;n.controller("HistoryController",["$scope","$localStorage","$state","$mdMedia",function(t,e,i,n){return e.imagesHistory?(t.divHeightStyle={height:100/3+"vw"},n("md")&&(t.divHeightStyle.height="25vw"),n("gt-md")&&(t.divHeightStyle.height=100/6+"vw"),t.history=e.imagesHistory.map(function(t){return{id:t.id,url:t.url,width:1,height:1,style:{width:"100%",overflow:"hidden"}}}),t.history.forEach(function(e,i){var n=new Image;n.onload=function(){t.history[i].width=n.width,t.history[i].height=n.height,n.height<n.width&&(t.history[i].style={height:"100%","max-width":"none","min-width":100/e.height*e.width+"%"})},n.src=e.url}),void(t.toImage=function(e){var n=t.public.history[e].id;i.go("index.image",{id:n})})):i.go("index")}])}]);